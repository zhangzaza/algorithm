AC 自动机，即 Aho-Corasick 自动机，是一种用于快速多模式字符串匹配的算法。这种算法由 Alfred V. Aho 和 Margaret J. Corasick 于 1975 年提出，主要用于在一个文本中同时查找多个模式字符串。它的应用非常广泛，尤其是在网络安全、文本处理和生物信息学等领域。

### 工作原理

AC 自动机的构建和匹配过程主要分为以下几个步骤：

1. **构建 Trie 树**：
   - 首先，将所有模式字符串插入到一个 Trie 树中。这是一种前缀树结构，可以有效地表示所有模式字符串的公共前缀。

2. **构建失败指针**：
   - 对于 Trie 树中的每个节点，构建一个失败指针（failure link）。失败指针指向当前节点匹配失败时应跳转的节点。
   - 失败指针的构建通常使用类似广度优先搜索（BFS）的方式进行。

3. **匹配过程**：
   - 在文本中逐字符进行扫描，使用 Trie 树来跟踪当前匹配的状态。
   - 当匹配失败时，利用失败指针跳转到下一个可能的匹配位置，而不是简单地回溯或移动一个字符。
   - 当到达一个模式字符串的终止节点时，即表示找到一个匹配。

### 复杂度

- **构建复杂度**：构建 Trie 树和失败指针的时间复杂度为 \(O(N)\)，其中 \(N\) 是所有模式字符串的总长度。
- **匹配复杂度**：匹配过程的时间复杂度为 \(O(M + K)\)，其中 \(M\) 是文本的长度，\(K\) 是所有匹配出现的次数。

### 应用

- **病毒检测**：可以用于快速扫描文件或网络流量，查找已知的病毒特征码。
- **过滤和审查**：在内容过滤系统中，用于检测和屏蔽不当内容。
- **基因序列分析**：用于在基因序列中查找特定的子序列模式。

AC 自动机是一种非常高效的多模式匹配算法，其主要优势在于能够同时处理多个模式字符串，并且在匹配过程中避免了很多不必要的字符比较。